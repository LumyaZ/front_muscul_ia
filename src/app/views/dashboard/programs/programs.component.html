<div class="programs-container">
  <app-header></app-header>

  <main class="programs-content">
    <div class="header">
      <div class="title-section">
        <h1>Programmes d'entra√Ænement</h1>
        <p>D√©couvrez et choisissez parmi nos programmes d'entra√Ænement personnalis√©s</p>
      </div>
      <!-- Suppression du bouton de cr√©ation - uniquement disponible dans you/programs -->
    </div>

    <div class="filters-section">
      <div class="search-bar">
        <input 
          type="text" 
          placeholder="Rechercher un programme..." 
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          class="search-input"
          [disabled]="loading"
        >
      </div>

      <div class="filters">
        <select [(ngModel)]="selectedDifficulty" (change)="onFilterChange()" class="filter-select" [disabled]="loading">
          <option value="">Toutes les difficult√©s</option>
          <option *ngFor="let difficulty of difficultyLevels" [value]="difficulty">
            {{ difficulty }}
          </option>
        </select>

        <select [(ngModel)]="selectedAudience" (change)="onFilterChange()" class="filter-select" [disabled]="loading">
          <option value="">Tous les publics</option>
          <option *ngFor="let audience of audiences" [value]="audience">
            {{ audience }}
          </option>
        </select>

        <button class="clear-filters-btn" (click)="clearFilters()" [disabled]="loading">
          Effacer les filtres
        </button>
      </div>
    </div>

    <div *ngIf="loading" class="loading">
      <div class="spinner"></div>
      <p>Chargement des programmes...</p>
    </div>

    <div *ngIf="error && !loading" class="error-message">
      <p>{{ error }}</p>
      <button (click)="loadPrograms()">R√©essayer</button>
    </div>

    <div *ngIf="!loading && !error" class="results-section" [class.animating]="isAnimating">
      <div class="categories-container">
        <div 
          *ngFor="let categoryGroup of categoryGroups; let i = index" 
          class="category-section"
          [style.background]="getCategoryColor(categoryGroup.category)"
        >
          <div class="category-header">
            <div class="category-info">
              <span class="category-icon">{{ categoryGroup.icon }}</span>
              <h2 class="category-title">{{ categoryGroup.category }}</h2>
            </div>
            
            <div class="category-nav">
              <button 
                class="nav-btn nav-left" 
                (click)="scrollLeft(i)"
                [disabled]="categoryGroup.programs.length <= 3"
                title="Faire d√©filer vers la gauche"
              >
                ‚Äπ
              </button>
              <button 
                class="nav-btn nav-right" 
                (click)="scrollRight(i)"
                [disabled]="categoryGroup.programs.length <= 3"
                title="Faire d√©filer vers la droite"
              >
                ‚Ä∫
              </button>
            </div>
          </div>

          <div class="programs-scroll-container" [id]="'category-' + i">
            <div class="programs-row">
              <div 
                *ngFor="let program of categoryGroup.programs; let j = index" 
                class="program-card"
                [class.private]="!program.isPublic"
                [style.animation-delay]="(j * 0.1) + 's'"
                [style.background]="getCardColor(categoryGroup.category)"
              >
                <div class="card-header">
                  <div class="difficulty-badge" [style.background-color]="getDifficultyColor(program.difficultyLevel)">
                    {{ program.difficultyLevel }}
                  </div>
                  <div *ngIf="!program.isPublic" class="private-badge">
                    Priv√©
                  </div>
                </div>

                <div class="card-content">
                  <h3 class="program-name">{{ program.name }}</h3>
                  <p class="program-description">{{ program.description }}</p>
                  
                  <div class="program-details">
                    <div class="detail-item">
                      <span class="detail-label">üìÖ</span>
                      <span>{{ program.durationWeeks }} semaines</span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-label">üîÑ</span>
                      <span>{{ program.sessionsPerWeek }}x/semaine</span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-label">‚è±Ô∏è</span>
                      <span>{{ formatDuration(60) }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-label">üë•</span>
                      <span>{{ program.targetAudience }}</span>
                    </div>
                  </div>

                  <div class="equipment-section">
                    <span class="equipment-label">√âquipement :</span>
                    <span class="equipment-text">√âquipement de base</span>
                  </div>
                </div>

                <div class="card-actions">
                  <button class="view-btn" (click)="viewProgram(program.id || 0)" title="Voir les d√©tails du programme">
                    Voir le programme
                  </button>
                  <button class="add-btn" (click)="addProgramToUser(program.id || 0)" title="Ajouter ce programme √† mes programmes">
                    Ajouter
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="categoryGroups.length === 0" class="no-results">
        <p>Aucun programme ne correspond √† vos crit√®res de recherche.</p>
        <button (click)="clearFilters()">Effacer les filtres</button>
      </div>
    </div>
  </main>

  <app-nav-bar [currentRoute]="'/dashboard/programs'"></app-nav-bar>
</div> 