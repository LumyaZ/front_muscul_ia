<div class="programs-container">
  <app-header></app-header>

  <main class="programs-content">
    <div class="header">
      <div class="title-section">
        <h1>Programmes d'entraÃ®nement</h1>
        <p>DÃ©couvrez et choisissez parmi nos programmes d'entraÃ®nement personnalisÃ©s</p>
      </div>
    </div>

    <div class="filters-section">
      <div class="search-bar">
        <input 
          type="text" 
          placeholder="Rechercher un programme..." 
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          class="search-input"
          [disabled]="loading"
        >
      </div>

      <div class="filters">
        <select [(ngModel)]="selectedDifficulty" (change)="onFilterChange()" class="filter-select" [disabled]="loading">
          <option value="">Toutes les difficultÃ©s</option>
          <option *ngFor="let difficulty of difficultyLevels" [value]="difficulty">
            {{ difficulty }}
          </option>
        </select>

        <select [(ngModel)]="selectedAudience" (change)="onFilterChange()" class="filter-select" [disabled]="loading">
          <option value="">Tous les publics</option>
          <option *ngFor="let audience of audiences" [value]="audience">
            {{ audience }}
          </option>
        </select>

        <button class="clear-filters-btn" (click)="clearFilters()" [disabled]="loading">
          Effacer les filtres
        </button>
      </div>
    </div>

    <div *ngIf="loading" class="loading">
      <div class="spinner"></div>
      <p>Chargement des programmes...</p>
    </div>

    <div *ngIf="error && !loading" class="error-message">
      <p>{{ error }}</p>
      <button (click)="loadPrograms()">RÃ©essayer</button>
    </div>

    <div *ngIf="!loading && !error" class="results-section" [class.animating]="isAnimating">
      <div class="categories-container">
        <div 
          *ngFor="let categoryGroup of categoryGroups; let i = index" 
          class="category-section"
          [style.background]="getCategoryColor(categoryGroup.category)"
        >
          <div class="category-header">
            <div class="category-info">
              <span class="category-icon">{{ categoryGroup.icon }}</span>
              <h2 class="category-title">{{ categoryGroup.category }}</h2>
            </div>
            
            <div class="category-nav">
              <button 
                class="nav-btn nav-left" 
                (click)="scrollLeft(i)"
                [disabled]="categoryGroup.programs.length <= 3"
                title="Faire dÃ©filer vers la gauche"
              >
                â€¹
              </button>
              <button 
                class="nav-btn nav-right" 
                (click)="scrollRight(i)"
                [disabled]="categoryGroup.programs.length <= 3"
                title="Faire dÃ©filer vers la droite"
              >
                â€º
              </button>
            </div>
          </div>

          <div class="programs-scroll-container" [id]="'category-' + i">
            <div class="programs-row">
              <div 
                *ngFor="let program of categoryGroup.programs; let j = index" 
                class="program-card"

                [style.animation-delay]="(j * 0.1) + 's'"
                [style.background]="getCardColor(categoryGroup.category)"
              >
                <div class="card-header">
                  <div class="difficulty-badge" [style.background-color]="getDifficultyColor(program.difficultyLevel)">
                    {{ program.difficultyLevel }}
                  </div>

                </div>

                <div class="card-content">
                  <h3 class="program-name">{{ program.name }}</h3>
                  <p class="program-description">{{ program.description }}</p>
                  
                  <div class="program-details">
                    <div class="detail-item">
                      <span class="detail-label">ðŸ“‚</span>
                      <span>{{ program.category }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-label">ðŸ‘¥</span>
                      <span>{{ program.targetAudience }}</span>
                    </div>
                  </div>

                  <div class="equipment-section">
                    <span class="equipment-label">Ã‰quipement :</span>
                    <span class="equipment-text">Ã‰quipement de base</span>
                  </div>
                </div>

                <div class="card-actions">
                  <button class="view-btn" (click)="viewProgram(program.id || 0)" title="Voir les dÃ©tails du programme">
                    Voir le programme
                  </button>
                  <button class="add-btn" (click)="addProgramToUser(program.id || 0)" title="Ajouter ce programme Ã  mes programmes">
                    Ajouter
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="categoryGroups.length === 0" class="no-results">
        <p>Aucun programme ne correspond Ã  vos critÃ¨res de recherche.</p>
        <button (click)="clearFilters()">Effacer les filtres</button>
      </div>
    </div>
  </main>

  <app-nav-bar [currentRoute]="'/dashboard/programs'"></app-nav-bar>
</div> 